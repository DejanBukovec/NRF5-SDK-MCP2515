<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v17.0.2: Scanning Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v17.0.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s113"><a href="../s113/index.html">S113 SoftDevice API</a></td>
<td class="doclinks" id="s122"><a href="../s122/index.html">S122 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s113","s122","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lib_ble_scan.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Scanning Module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="whichSDs"><span>This information applies to the following SoftDevices: <b>S132, S140</b></span></div><p>The Scanning Module handles the BLE scanning for your application. You can use it to find an advertising device and establish a connection with it. The scan can be narrowed down to the device of a specific type by using filters and the whitelist. The module can be used for most of the SDK BLE examples.</p>
<p>The Scanning Module can work in one of the following modes:</p>
<ul>
<li>simple mode without using filters and the whitelist, or</li>
<li>advanced mode that allows you to use advanced filters or the whitelist.</li>
</ul>
<p>The module can automatically establish a connection after a filter match or successful identification of a device from the whitelist.</p>
<h1><a class="anchor" id="scan_usage"></a>
Usage</h1>
<table class="doxtable">
<tr>
<th>Action </th><th>Description</th></tr>
<tr>
<td>Initialization </td><td>The module must be initialized with <a class="el" href="group__nrf__ble__scan.html#gac78a15d07a269364b33418ffb1fa8178">nrf_ble_scan_init</a> that can be called without event handler and initialization structure. When initialization structure is passed as NULL, the default static configuration is used. This configuration is also used when you use an initialization structure with NULL pointers to scan parameters and connection parameters. Event handler also can be initialized as NULL, but then the application does not get events that inform about a filter or whitelist match, or about a connection error during the automatic connection. </td></tr>
<tr>
<td>Starting scanning </td><td>When initialization completes, you can start scanning with <a class="el" href="group__nrf__ble__scan.html#ga953e33a07f943994062118b07bdb4a2d">nrf_ble_scan_start</a>. In the simplest mode when you do not using event handler, the connection can be established when <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___e_n_u_m_e_r_a_t_i_o_n_s.html#ggada486dd3c0cce897b23a887bed284fefa41ba498a9fda3e1cd345f4454a582bd9">BLE_GAP_EVT_ADV_REPORT</a> occurs. </td></tr>
<tr>
<td>Changing parameters </td><td>Call the function <a class="el" href="group__nrf__ble__scan.html#ga0b2219a3b3cefebcf27f386554c4d3e6">nrf_ble_scan_params_set</a> to change parameters. </td></tr>
<tr>
<td>Stopping scanning </td><td>Call the function <a class="el" href="group__nrf__ble__scan.html#ga03ac11800240ffb210fba5b863cbadca">nrf_ble_scan_stop</a> to stop scanning. </td></tr>
<tr>
<td>Resuming scanning </td><td>The Scanning Module resumes scanning after receiving advertising reports. Scanning stops if the module established the connection automatically, or if the application calls <a class="el" href="group__nrf__ble__scan.html#ga03ac11800240ffb210fba5b863cbadca">nrf_ble_scan_stop</a> or <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___f_u_n_c_t_i_o_n_s.html#gacca0e56084c7b3ed832b1bfa3911b7fe">sd_ble_gap_connect</a>. </td></tr>
</table>
<h1><a class="anchor" id="scan_usage_init"></a>
Initialization</h1>
<p>The Scanning Module can be initialized with a simple or an advanced method. Both correspond to some extent to the respective Scanning Module modes.</p>
<h2><a class="anchor" id="scan_usage_simple_simple_init"></a>
Simple initialization</h2>
<p>You can use the simple initialization with the default scanning parameters when you want the Scanning Module to work in the simple mode without filtering and the whitelist.</p>
<div class="fragment"><div class="line"><a class="code" href="group__sdk__error.html#gaf6c20fb483036617204f12e99e0b997b" title="API Result.">ret_code_t</a> err_code;</div>
<div class="line"></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#gac78a15d07a269364b33418ffb1fa8178" title="Function for initializing the Scanning Module.">nrf_ble_scan_init</a>(&amp;m_scan, NULL, NULL);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga953e33a07f943994062118b07bdb4a2d" title="Function for starting scanning.">nrf_ble_scan_start</a>(&amp;m_scan);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
</div><!-- fragment --><h2><a class="anchor" id="scan_usage_advanced_init"></a>
Advanced initialization</h2>
<p>You can use the advanced initialization when you want the Scanning Module to work in either the simple mode without filtering and the whitelist or the advanced mode that uses advanced filters. You can configure this initialization to your needs, for example by disabling the whitelist and enabling the automatic connection establishing.</p>
<div class="fragment"><div class="line"><span class="comment">/**&lt; Scan parameters requested for scanning and connection. */</span></div>
<div class="line"><span class="keyword">static</span> <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/structble__gap__scan__params__t.html">ble_gap_scan_params_t</a> <span class="keyword">const</span> m_scan_param =</div>
<div class="line">{</div>
<div class="line">    .<a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/structble__gap__scan__params__t.html#a7f3eda85d15916ad467a81faba18f076">active</a>        = 0x01,</div>
<div class="line">    .interval      = <a class="code" href="group__nrf__ble__scan__config.html#ga1c56e7d5e4fdc3af5d61c00cddf664a4" title="Scanning interval. Determines the scan interval in units of 0.625 millisecond.">NRF_BLE_SCAN_SCAN_INTERVAL</a>,</div>
<div class="line">    .window        = <a class="code" href="group__nrf__ble__scan__config.html#ga4a5e2e4c921d6008764accaec9dfc133" title="Scanning window. Determines the scanning window in units of 0.625 millisecond.">NRF_BLE_SCAN_SCAN_WINDOW</a>,</div>
<div class="line">    .filter_policy = <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___s_c_a_n___f_i_l_t_e_r___p_o_l_i_c_i_e_s.html#ga3fcd58550a48f5f049bb1de2a0811b32">BLE_GAP_SCAN_FP_WHITELIST</a>,</div>
<div class="line">    .timeout       = SCAN_DURATION_WHITELIST,</div>
<div class="line">    .scan_phys     = <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___p_h_y_s.html#ga69dd87e677e5b1fc57b0874fe414e6d0">BLE_GAP_PHY_1MBPS</a>,</div>
<div class="line">    .extended      = <span class="keyword">true</span>,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__sdk__error.html#gaf6c20fb483036617204f12e99e0b997b" title="API Result.">ret_code_t</a> err_code;</div>
<div class="line">    <a class="code" href="structnrf__ble__scan__init__t.html" title="Structure for Scanning Module initialization.">nrf_ble_scan_init_t</a> scan_init;</div>
<div class="line"></div>
<div class="line">    memset(&amp;scan_init, 0, <span class="keyword">sizeof</span>(scan_init));</div>
<div class="line"></div>
<div class="line">    scan_init.<a class="code" href="structnrf__ble__scan__init__t.html#a6689dbd50ba19c92827dfa2b955a5e56">p_scan_param</a>     = &amp;m_scan_param;</div>
<div class="line">    scan_init.<a class="code" href="structnrf__ble__scan__init__t.html#af7da08063caf45db7b911d81fbf43ddc">connect_if_match</a> = <span class="keyword">true</span>;</div>
<div class="line">    scan_init.<a class="code" href="structnrf__ble__scan__init__t.html#a475238564c9298bd463a04b19bdf5fe2">conn_cfg_tag</a>     = APP_BLE_CONN_CFG_TAG;</div>
<div class="line"></div>
<div class="line">    err_code = <a class="code" href="group__nrf__ble__scan.html#gac78a15d07a269364b33418ffb1fa8178" title="Function for initializing the Scanning Module.">nrf_ble_scan_init</a>(&amp;m_scan, &amp;scan_init, scan_evt_handler);</div>
<div class="line">    <a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line">    err_code = <a class="code" href="group__nrf__ble__scan.html#ga953e33a07f943994062118b07bdb4a2d" title="Function for starting scanning.">nrf_ble_scan_start</a>(&amp;m_scan);</div>
<div class="line">    <a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
</div><!-- fragment --><p>If you want to use filters or the whitelist, you can configure the module during initialization to connect automatically after a filter match or successful identification of a device from the whitelist.</p>
<dl class="section note"><dt>Note</dt><dd>When setting connection-specific configurations with <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga4edae2bac8c68b672c0fa101ed2c687f">sd_ble_cfg_set</a>, you must create a tag for each configuration. If your application uses the Scanning Module with automatic connection, this tag must be provided when calling <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___f_u_n_c_t_i_o_n_s.html#gabbd87dea8f218d2a7e12c40cfbc6a7d2">sd_ble_gap_scan_start()</a> and <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___f_u_n_c_t_i_o_n_s.html#gacca0e56084c7b3ed832b1bfa3911b7fe">sd_ble_gap_connect()</a>.</dd></dl>
<h1><a class="anchor" id="scan_whitelist"></a>
Whitelist</h1>
<p>The whitelist stores information about all the device connections and bonding. If you enable the whitelist, the application receives advertising packets only from the devices that are on the whitelist.</p>
<dl class="section warning"><dt>Warning</dt><dd>If you use the whitelist, you must pass the event handler during the module initialization. The initial scanning with whitelist generates <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037da9b27f153c654f7112f078e88b2e14ef5">NRF_BLE_SCAN_EVT_WHITELIST_REQUEST</a> to the main application. The application must react to this event by either setting up the whitelist or switching off the whitelist scan. Otherwise, an error is reported when the scan starts.</dd></dl>
<p>You can use <a class="el" href="group__nrf__ble__scan.html#ga0b2219a3b3cefebcf27f386554c4d3e6">nrf_ble_scan_params_set</a> to enable or disable the whitelist scan both during and after the initialization of the module.</p>
<dl class="section note"><dt>Note</dt><dd>When you use <a class="el" href="group__nrf__ble__scan.html#ga0b2219a3b3cefebcf27f386554c4d3e6">nrf_ble_scan_params_set</a> during the ongoing scan, scanning is stopped. To resume scanning, use <a class="el" href="group__nrf__ble__scan.html#ga953e33a07f943994062118b07bdb4a2d">nrf_ble_scan_start</a>.</dd></dl>
<p>Finding an advertising package that belongs to a whitelisted device generates the <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037da5fca669cb089398f6061f39289af8d48">NRF_BLE_SCAN_EVT_WHITELIST_ADV_REPORT</a> event.</p>
<dl class="section note"><dt>Note</dt><dd>When using the whitelist, filters are inactive.</dd></dl>
<h1><a class="anchor" id="scan_filters"></a>
Filters</h1>
<p>The module can set scanning filters of different type and mode. When a filter is matched, it generates <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037da5583c9bfadab473ec744ffd213458e68">NRF_BLE_SCAN_EVT_FILTER_MATCH</a> to the main application. If the filter matching is enabled and no filter is matched, <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037dab9c71c1d8f62fd9938069a9409e4205a">NRF_BLE_SCAN_EVT_NOT_FOUND</a> is generated.</p>
<h2><a class="anchor" id="scan_filters_type"></a>
Filter types</h2>
<p>The following table shows the available filter types.</p>
<table class="doxtable">
<tr>
<th>Filter type </th><th>Details</th></tr>
<tr>
<td>Name </td><td>Filter set to the target name.<br/>
The maximum length of the name corresponds to <a class="el" href="group__nrf__ble__scan__config.html#gad0415325c0490c8080e3b81a04a941f0">NRF_BLE_SCAN_NAME_MAX_LEN</a>.<br/>
The maximum number of filters of this type corresponds to <a class="el" href="group__nrf__ble__scan__config.html#ga3b552e379b2060226a4af059cdbba4c7">NRF_BLE_SCAN_NAME_CNT</a>. </td></tr>
<tr>
<td>Short name </td><td>Filter set to the short target name.<br/>
The maximum length of the name corresponds to <a class="el" href="group__nrf__ble__scan__config.html#ga7cb62d261829a73c84c63d6ab78bbb33">NRF_BLE_SCAN_SHORT_NAME_MAX_LEN</a>.<br/>
The maximum number of filters of this type corresponds to <a class="el" href="group__nrf__ble__scan__config.html#ga7d7cee184dfd3d0b7ad7d83183e822fe">NRF_BLE_SCAN_SHORT_NAME_CNT</a>. </td></tr>
<tr>
<td>Address </td><td>Filter set to the target address.<br/>
The maximum number of filters of this type corresponds to <a class="el" href="group__nrf__ble__scan__config.html#gaf6616e2206be0286947ff1f489bb95f4">NRF_BLE_SCAN_ADDRESS_CNT</a>. </td></tr>
<tr>
<td>UUID </td><td>Filter set to the target UUID.<br/>
The maximum number of filters of this type corresponds to <a class="el" href="group__nrf__ble__scan__config.html#ga1c4466e3c05de97dfa7bfd2dda7bc01b">NRF_BLE_SCAN_UUID_CNT</a>. </td></tr>
<tr>
<td>Appearance </td><td>Filter set to the target appearance.<br/>
The maximum number of filters of this type corresponds to <a class="el" href="group__nrf__ble__scan__config.html#ga77acca4fe6e1b030779cd7a7f5c9a15c">NRF_BLE_SCAN_APPEARANCE_CNT</a>. </td></tr>
</table>
<h2><a class="anchor" id="scan_filter_mode"></a>
Filter modes</h2>
<p>The following two filter modes are available.</p>
<table class="doxtable">
<tr>
<th>Filter mode </th><th>Behavior</th></tr>
<tr>
<td>Normal </td><td>Only one of the filters you set, regardless of the type, must be matched to generate an event. </td></tr>
<tr>
<td>Multifilter </td><td>In this mode, at least one filter from each filter type you set must be matched to generate an event, with UUID as an exception: all specified UUIDs must match in this mode.<br/>
<br/>
Example: Several filters are set for name, address, UUID, and appearance. To generate the <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037da5583c9bfadab473ec744ffd213458e68">NRF_BLE_SCAN_EVT_FILTER_MATCH</a> event, the following types must match:<br/>
- one of the address filters,<br/>
- one of the name filters,<br/>
- one of the appearance filters,<br/>
- all of the UUID filters.<br/>
Otherwise, the <a class="el" href="group__nrf__ble__scan.html#gga7b8b9be133ad06a1fab37ab63ac8037dab9c71c1d8f62fd9938069a9409e4205a">NRF_BLE_SCAN_EVT_NOT_FOUND</a> event is generated. </td></tr>
</table>
<h2><a class="anchor" id="scan_filters_usage"></a>
Filter usage</h2>
<p>You can use filters after module initialization. You can enable filters with <a class="el" href="group__nrf__ble__scan.html#ga03a7e546b8c853dcca70a2dc259904d7">nrf_ble_scan_filters_enable</a>. Filters can be activated for one filter type, or for a combination of several filter types.</p>
<div class="fragment"><div class="line"><span class="comment">// Enable the filter on the address in the normal mode.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga03a7e546b8c853dcca70a2dc259904d7" title="Function for enabling filtering.">nrf_ble_scan_filters_enable</a>(&amp;m_scan,</div>
<div class="line">                                       <a class="code" href="group___n_r_f___b_l_e___s_c_a_n___f_i_l_t_e_r___m_o_d_e.html#ga138d4faec04aaeae907f94bffccf013e">NRF_BLE_SCAN_ADDR_FILTER</a>,</div>
<div class="line">                                       <span class="keyword">false</span>);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Enable the filter on the name and UUID in the normal mode.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga03a7e546b8c853dcca70a2dc259904d7" title="Function for enabling filtering.">nrf_ble_scan_filters_enable</a>(&amp;m_scan,</div>
<div class="line">                                       <a class="code" href="group___n_r_f___b_l_e___s_c_a_n___f_i_l_t_e_r___m_o_d_e.html#gabcc0343ab95968f7cf63141ca07cb997">NRF_BLE_SCAN_NAME_FILTER</a> | <a class="code" href="group___n_r_f___b_l_e___s_c_a_n___f_i_l_t_e_r___m_o_d_e.html#ga0b1c78fd1f109baa8934df0b148f46e1">NRF_BLE_SCAN_UUID_FILTER</a>,</div>
<div class="line">                                       <span class="keyword">false</span>);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Enable the multifilter mode.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga03a7e546b8c853dcca70a2dc259904d7" title="Function for enabling filtering.">nrf_ble_scan_filters_enable</a>(&amp;m_scan,</div>
<div class="line">                                       <a class="code" href="group___n_r_f___b_l_e___s_c_a_n___f_i_l_t_e_r___m_o_d_e.html#ga53e405dd1fe7bccff32cbd58d4d31fb7">NRF_BLE_SCAN_ALL_FILTER</a>,</div>
<div class="line">                                       <span class="keyword">true</span>);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
</div><!-- fragment --><p>To disable all enabled filters, use <a class="el" href="group__nrf__ble__scan.html#gaf17e49d0ca649bfac1657a399cca1c0c">nrf_ble_scan_filters_disable</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// Disable filters.</span></div>
<div class="line">err_code = nrf_ble_scan_filter_disable(&amp;m_scan);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
</div><!-- fragment --><p>Filters can be set and removed dynamically while the application is running, regardless of whether they are enabled or disabled. Switching off a filter does not reset filter settings. Call <a class="el" href="group__nrf__ble__scan.html#ga56c5cf1561dcfbc3d9197c8b0941d3ad">nrf_ble_scan_filter_set</a> to set the selected filter type <a class="el" href="group__nrf__ble__scan.html#ga3b7f99163d73b036dd4b61f169ca6a1c">nrf_ble_scan_filter_type_t</a> or call <a class="el" href="group__nrf__ble__scan.html#gaf07d1e76c31228157bf3c75f94f300bd">nrf_ble_scan_all_filter_remove</a> to remove all filters.</p>
<div class="fragment"><div class="line"><span class="comment">// Set filter on target name.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga56c5cf1561dcfbc3d9197c8b0941d3ad" title="Function for adding any type of filter to the scanning.">nrf_ble_scan_filter_set</a>(&amp;m_scan, <a class="code" href="group__nrf__ble__scan.html#gga3b7f99163d73b036dd4b61f169ca6a1ca41444b5a2141cff877577f04256e4388">SCAN_NAME_FILTER</a>, m_target_periph_name);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Set filter on target UUID.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#ga56c5cf1561dcfbc3d9197c8b0941d3ad" title="Function for adding any type of filter to the scanning.">nrf_ble_scan_filter_set</a>(&amp;m_scan, <a class="code" href="group__nrf__ble__scan.html#gga3b7f99163d73b036dd4b61f169ca6a1cae9b5670280fdd985f826aacaff7e29bb">SCAN_UUID_FILTER</a>, &amp;target_uuid);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Remove all filters.</span></div>
<div class="line">err_code = <a class="code" href="group__nrf__ble__scan.html#gaf07d1e76c31228157bf3c75f94f300bd" title="Function for removing all set filters.">nrf_ble_scan_all_filter_remove</a>(&amp;m_scan);</div>
<div class="line"><a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(err_code);</div>
</div><!-- fragment --><h1><a class="anchor" id="scan_msg"></a>
Message sequence chart</h1>
<p>See the following short examples of a typical application to see the Scanning Module flow and how the module is used.</p>
<h2><a class="anchor" id="scan_msg_1"></a>
Message sequence chart example 1: Simplest mode</h2>
<p>In the first example, the application starts scanning in the simplest mode, without filters and the event handler.</p>
<div align="center">
<img src="msc_inline_mscgraph_8.png" alt="msc_inline_mscgraph_8" border="0" usemap="#msc_inline_mscgraph_8.map"/>
<map name="msc_inline_mscgraph_8.map" id="msc_inline_mscgraph_8.map"></map>
</div>
<h2><a class="anchor" id="scan_msg_2"></a>
Message sequence chart example 2: Scanning with filters</h2>
<p>In the following second example, the application starts scanning, then enables and sets the filters. Automatic connections after matching filters are also shown.</p>
<div align="center">
<img src="msc_inline_mscgraph_9.png" alt="msc_inline_mscgraph_9" border="0" usemap="#msc_inline_mscgraph_9.map"/>
<map name="msc_inline_mscgraph_9.map" id="msc_inline_mscgraph_9.map"></map>
</div>
<h2><a class="anchor" id="scan_msg_3"></a>
Message sequence chart example 3: Scanning with whitelist</h2>
<p>The following third example shows scanning with whitelist.</p>
<div align="center">
<img src="msc_inline_mscgraph_10.png" alt="msc_inline_mscgraph_10" border="0" usemap="#msc_inline_mscgraph_10.map"/>
<map name="msc_inline_mscgraph_10.map" id="msc_inline_mscgraph_10.map"></map>
</div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon Sep 14 2020" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
