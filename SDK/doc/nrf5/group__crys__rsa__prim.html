<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v17.0.2: CryptoCell RSA primitive APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v17.0.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s113"><a href="../s113/index.html">S113 SoftDevice API</a></td>
<td class="doclinks" id="s122"><a href="../s122/index.html">S122 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s113","s122","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__crys__rsa__prim.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptoCell RSA primitive APIs<div class="ingroups"><a class="el" href="group__crys__rsa.html">CryptoCell RSA APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaee2c7a3feededce55f9fc9524850e135"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaee2c7a3feededce55f9fc9524850e135"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#gaee2c7a3feededce55f9fc9524850e135">CRYS_RSA_PRIM_Sign</a>&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">CRYS_RSA_PRIM_Decrypt</a></td></tr>
<tr class="memdesc:gaee2c7a3feededce55f9fc9524850e135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSASP1 algorithm, as defined in [PKCS1_2.1] - 6.2.1, as a call to <a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e" title="Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2.">CRYS_RSA_PRIM_Decrypt</a>, since the signature primitive is identical to the decryption primitive. <br/></td></tr>
<tr class="separator:gaee2c7a3feededce55f9fc9524850e135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae47765de215324bc8a8c318b8432938e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae47765de215324bc8a8c318b8432938e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#gae47765de215324bc8a8c318b8432938e">CRYS_RSA_PRIM_Verify</a>&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">CRYS_RSA_PRIM_Encrypt</a></td></tr>
<tr class="memdesc:gae47765de215324bc8a8c318b8432938e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSAVP1 algorithm, as defined in [PKCS1_2.1] - 6.2.2, as a call to <a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3" title="Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1.">CRYS_RSA_PRIM_Encrypt</a>. <br/></td></tr>
<tr class="separator:gae47765de215324bc8a8c318b8432938e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">CRYS_RSA_PRIM_Encrypt</a> (<a class="el" href="struct_c_r_y_s___r_s_a_user_pub_key__t.html">CRYS_RSAUserPubKey_t</a> *UserPubKey_ptr, <a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *PrimeData_ptr, uint8_t *Data_ptr, uint16_t DataSize, uint8_t *Output_ptr)</td></tr>
<tr class="memdesc:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1.  <a href="#ga6525013327c2d37e40bbcb20f6fd85d3">More...</a><br/></td></tr>
<tr class="separator:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga602882c564790dc76b53f652af148e7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">CRYS_RSA_PRIM_Decrypt</a> (<a class="el" href="struct_c_r_y_s___r_s_a_user_priv_key__t.html">CRYS_RSAUserPrivKey_t</a> *UserPrivKey_ptr, <a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *PrimeData_ptr, uint8_t *Data_ptr, uint16_t DataSize, uint8_t *Output_ptr)</td></tr>
<tr class="memdesc:ga602882c564790dc76b53f652af148e7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2.  <a href="#ga602882c564790dc76b53f652af148e7e">More...</a><br/></td></tr>
<tr class="separator:ga602882c564790dc76b53f652af148e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section note"><dt>Note</dt><dd>Direct use of primitive functions, rather than schemes to protect data, is strongly discouraged as primitive functions are susceptible to well-known attacks. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga602882c564790dc76b53f652af148e7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a> CRYS_RSA_PRIM_Decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_user_priv_key__t.html">CRYS_RSAUserPrivKey_t</a> *&#160;</td>
          <td class="paramname"><em>UserPrivKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *&#160;</td>
          <td class="paramname"><em>PrimeData_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Data_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>DataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Output_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2. </p>
<dl class="section return"><dt>Returns</dt><dd>CRYS_OK on success. </dd>
<dd>
A non-zero value from crys_rsa_error.h on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UserPrivKey_ptr</td><td>Pointer to the private key data structure. The key representation (pair or quintuple) and hence the RSA algorithm (CRT or not-CRT) is determined by enum value in the structure <a class="el" href="group__crys__rsa__build.html#gabdadf6d31aa61300edc1e9a3e1045c0e" title="Builds a CRYSRSAPrivKey_t private key structure with the provided modulus and exponent, marking the key as a non-CRT key.">CRYS_RSA_Build_PrivKey</a> or <a class="el" href="group__crys__rsa__build.html#ga08e98a8d11c546c99cbe82af1e9f151a" title="Builds a CRYSRSAPrivKey_t private key structure with the provided parameters, marking the key as a CR...">CRYS_RSA_Build_PrivKeyCRT</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PrimeData_ptr</td><td>Pointer to a temporary structure containing internal buffers required for the RSA operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data_ptr</td><td>Pointer to the data to be decrypted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size (in bytes) of input data must be &le; modulus size. If the size is smaller (not recommendet), then the data will be zero-padded by the function on left side up to the modulus size and therefore, after further decrypt operation,its result will contain zero-padding also. If the function is used for recovering the plain data from result of inverse function (CRYS_RSA_PRIM_Encrypt), the input size must be equal to modulus size exactly. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Output_ptr</td><td>Pointer to the decrypted data. The buffer size must be &le; the modulus size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga6525013327c2d37e40bbcb20f6fd85d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a> CRYS_RSA_PRIM_Encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_user_pub_key__t.html">CRYS_RSAUserPubKey_t</a> *&#160;</td>
          <td class="paramname"><em>UserPubKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *&#160;</td>
          <td class="paramname"><em>PrimeData_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Data_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>DataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Output_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1. </p>
<dl class="section return"><dt>Returns</dt><dd>CRYS_OK on success. </dd>
<dd>
A non-zero value from crys_rsa_error.h on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UserPubKey_ptr</td><td>Pointer to the public key data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PrimeData_ptr</td><td>Pointer to a temporary structure containing internal buffers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data_ptr</td><td>Pointer to the data to encrypt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size (in bytes) of input data must be &le; modulus size. If is smaller, then the function padds it by zeros on left side up to the modulus size and therefore, after further decrypt operation, its result will contain zero-padding also. If the function is used for recovering the plain data from result of inverse function (CRYS_RSA_PRIM_Decrypt), the input size must be equal to modulus size exactly. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Output_ptr</td><td>Pointer to the encrypted data. The buffer size must be &ge; the modulus size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon Sep 14 2020" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
