<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v17.0.2: Infineon OPTIGA™ Trust X Software Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v17.0.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s113"><a href="../s113/index.html">S113 SoftDevice API</a></td>
<td class="doclinks" id="s122"><a href="../s122/index.html">S122 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s113","s122","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lib_ifx_optiga.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Infineon OPTIGA™ Trust X Software Framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Infineon OPTIGA Trust X is a high-end security controller with a versatile set of features to secure devices.</p>
<p>See <a href="https://github.com/Infineon/Assets/blob/master/PDFs/OPTIGA_Trust_X_Datasheet_v2.70.pdf" target="_blank">Trust X Datasheet</a> for detailed information on the framework.</p>
<h1><a class="anchor" id="lib_ifx_optiga_architecture"></a>
Trust X Software Framework</h1>
<p>On a Nordic platform, there are two APIs to use the functions of Trust X:</p>
<ol type="1">
<li>The <a class="el" href="lib_crypto_backend_optiga.html">OPTIGA™ backend</a>, which operates on top of the native Trust X API.</li>
<li>The native Trust X API, split into Crypt API and Util API.</li>
</ol>
<p>While the backend API implementation is Nordic-specific, the native API is portable and also available on other host platforms. Furthermore, the native API exposes the complete function set of Trust X that is required for personalization. It includes, for example, functions for reading and writing data objects.</p>
<div class="image">
<img src="optiga_trust_x_stack_generic.jpg" alt="optiga_trust_x_stack_generic.jpg"/>
<div class="caption">
Trust X Software Framework</div></div>
<p> The OPTIGA Trust X software framework is composed of the following layers (top to bottom):</p>
<ul>
<li>Crypt API (<a href="https://github.com/Infineon/optiga-trust-x/wiki/Trust-X-Crypt-API" target="_blank">Crypt API</a>) and Util API (<a href="https://github.com/Infineon/optiga-trust-x/wiki/Trust-X-Util-API" target="_blank">Util API</a>), a set of high-level APIs to use Trust X services.</li>
<li>OPTIGA Trust X Command Library, a lower-level API, documented in the Solution Reference manual <a href="https://github.com/Infineon/Assets/raw/master/PDFs/OPTIGA_Trust_X_SolutionReferenceManual_v1.35.pdf" target="_blank">Trust X Solution Reference Manual (SRM)</a>.</li>
<li>Infineon I2C Protocol (<a href="https://github.com/Infineon/Assets/raw/master/PDFs/IFXI2CProtocol_v1.65.pdf" target="_blank">Infineon I2C Protocol</a>) implementation to exchange commands via I2C with the Trust X device.</li>
<li>An implementation of the Platform Abstraction Layer (PAL) for the Nordic nRF5x platform: pal_gpio.c, pal_i2c.c, pal_ifx_i2c_config.c, pal_os.c and pal_os_lock.c.</li>
</ul>
<h1><a class="anchor" id="lib_ifx_optiga_links"></a>
External resources and documentation</h1>
<p>More information can be found at:</p>
<ul>
<li>Infineon OPTIGA Trust X product page: <a href="https://www.infineon.com/cms/en/product/security-smart-card-solutions/optiga-embedded-security-solutions/optiga-trust/optiga-trust-x-sls-32aia" target="_blank">OPTIGA Trust X product website</a></li>
<li>Latest version of OPTIGA Trust X software framework: <a href="https://github.com/Infineon/optiga-trust-x" target="_blank">OPTIGA™ Trust X Software Framework on Github.com</a></li>
<li>Latest version of OPTIGA Trust X documentation: <a href="https://github.com/Infineon/optiga-trust-x/wiki" target="_blank">OPTIGA™ Trust X Wiki on Github.com</a></li>
<li>List of technical documents and specifications: <a href="https://github.com/Infineon/optiga-trust-x#documentation" target="_blank">List of OPTIGA™ Trust X Documents</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The Infineon OPTIGA Trust X hardware security module must be acquired separately, for example on a development board in Arduino-compatible form factor, and compatible with the Nordic development kit. For more information, see <a href="https://github.com/Infineon/optiga-trust-x#evaluation-and-developement-kits" target="_blank">Trust X evaluation and development kits</a>.</dd></dl>
<h1><a class="anchor" id="lib_ifx_optiga_readme"></a>
Important information</h1>
<p>Read this section before you start the configuration process.</p>
<h2><a class="anchor" id="lib_ifx_optiga_readme_hwsetup"></a>
Supported Hardware Configurations</h2>
<p>The nRF5x PAL supports the Nordic PCA10040 and PCA10056 boards with two different shields. It provides a set of pre-configured pin configurations in <code>pal_pin_config.h</code>.</p>
<p>To select a configuration, set one of the following defines to <code>1</code>:</p>
<table class="doxtable">
<tr>
<th>Hardware Configuration </th><th>C Macro </th></tr>
<tr>
<td>My IoT adapter + Trust X Shield2Go in Slot 1 </td><td><code>OPTIGA_PIN_CONFIG_MYIOT_SLOT1</code> </td></tr>
<tr>
<td>My IoT adapter + Trust X Shield2Go in Slot 2/3 </td><td><code>OPTIGA_PIN_CONFIG_MYIOT_SLOT2_3</code> </td></tr>
<tr>
<td>Trust X Shield onboard OPTIGA </td><td><code>OPTIGA_PIN_CONFIG_TRUSTX_SHIELD</code> </td></tr>
<tr>
<td>Trust X Shield + Trust X Shield2Go </td><td><code>OPTIGA_PIN_CONFIG_2GO</code> </td></tr>
</table>
<h3><a class="anchor" id="lib_ifx_optiga_readme_hwsetup_myiot"></a>
My IoT adapter</h3>
<p><a href="https://www.infineon.com/cms/en/product/evaluation-boards/my-iot-adapter/" target="_blank">My IoT Adapter</a> (in Arduino form factor) supports three slots of 2Go form factor boards. A <a href="https://www.infineon.com/cms/en/product/evaluation-boards/s2go-security-optiga-x/" target="_blank">Trust X Shield2Go</a> can be plugged into any of the three slots.</p>
<p>If the Trust X Shield2Go is plugged into slot 1, select <code>OPTIGA_PIN_CONFIG_MYIOT_SLOT1</code>; otherwise, use <code>OPTIGA_PIN_CONFIG_MYIOT_SLOT2_3</code>.</p>
<p>For more information about My IoT, visit the <a href="https://www.infineon.com/cms/en/tools/landing/infineon-for-makers/shield-2go-my-iot/" target="_blank">Shield2Go &amp; My IoT</a> page.</p>
<h3><a class="anchor" id="lib_ifx_optiga_readme_hwsetup_trustxshield"></a>
Trust X Shield</h3>
<p>The Trust X Shield (in Arduino form factor) has an OPTIGA Trust X soldered directly on the board. It can select Trust X Shield2Go board plugged into the respective slot abd enable and disable <code>VDD</code> for each slot.</p>
<p>If you want to use the onboard OPTIGA Trust X, use <code>OPTIGA_PIN_CONFIG_TRUSTX_SHIELD</code>.</p>
<p>If you want to use a Trust X Shield2Go plugged into the <code>OPTIGA</code> slot, use <code>OPTIGA_PIN_CONFIG_MYIOT_SLOT2_3</code>.</p>
<h2><a class="anchor" id="lib_ifx_optiga_readme_hwsetup_trustxshield_conflict"></a>
Pin Conflict with Nordic PCA10040 and Trust X Shield</h2>
<p>When using the Nordic PCA10040 board with the Trust X Shield, the LEDs BSP_BOARD_LED_1 and BSP_BOARD_LED_2 must not be used. These pins are needed for the correct operation of the OPTIGA Trust X.</p>
<h2><a class="anchor" id="lib_ifx_optiga_readme_configuration"></a>
Required configuration</h2>
<p>Due to EasyDMA restrictions on nRF52832 devices, it is necessary to set a project-level define <code>DL_MAX_FRAME_SIZE=250</code> to use the nRF5x Platform Abstraction Layer (PAL). This PAL is required by the Trust X host library, which is used by the OPTIGA backend implementation.</p>
<p>The OPTIGA software framework allocates memory on the heap. For proper operation, the heap should be equal to or larger than 8,192 Bytes.</p>
<h2><a class="anchor" id="lib_ifx_optiga_readme_compatiblity"></a>
Hardware compatibility</h2>
<p>When using the Nordic PCA10040 board with the Trust X Shield the LEDs <code>BSP_BOARD_LED_1</code> and <code>BSP_BOARD_LED_2</code> must not be used. These pins are needed for the correct operation of the OPTIGA Trust X.</p>
<p>To use the PAL together with other I2C devices and be able to run it also on a BLE Shield2Go, define <code>IFX_2GO_SUPPORT</code> on project-level.</p>
<h1><a class="anchor" id="lib_fix_optiga_native"></a>
Trust X Crypt and Util API (native API)</h1>
<h2><a class="anchor" id="lib_fix_optiga_native_init"></a>
Initialization</h2>
<p>To use Infineon Trust X without the nrf_crypto API and backend implementation, it must be initialized. The following code snippet demonstrates how to do this: </p>
<div class="fragment"><div class="line">int32_t status = (int32_t) OPTIGA_LIB_ERROR;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Initialize PAL</span></div>
<div class="line">pal_gpio_init();</div>
<div class="line">pal_os_event_init();</div>
<div class="line"></div>
<div class="line">status = <a class="code" href="group__gr_optiga_util.html#gafb210fdda8a5f983f5fc5175abc508e3" title="Initializes the communication with optiga.">optiga_util_open_application</a>(&amp;<a class="code" href="structoptiga__comms.html" title="optiga comms structure">optiga_comms</a>);</div>
<div class="line"><span class="keywordflow">if</span> (OPTIGA_LIB_SUCCESS != status)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__nrf__log.html#gac8d37e95648e05580513df9aaddf02c3" title="Macro for logging error messages. It takes a printf-like, formatted string with up to seven arguments...">NRF_LOG_INFO</a>(<span class="stringliteral">&quot;Failure: CmdLib_OpenApplication(): 0x%04X&quot;</span>, status);</div>
<div class="line">}</div>
<div class="line"><a class="code" href="group__nrf__log.html#gac8d37e95648e05580513df9aaddf02c3" title="Macro for logging error messages. It takes a printf-like, formatted string with up to seven arguments...">NRF_LOG_INFO</a>(<span class="stringliteral">&quot;Success: CmdLib_OpenApplication(): 0x%04X&quot;</span>, status);</div>
</div><!-- fragment --><h2><a class="anchor" id="lib_fix_optiga_native_perso"></a>
Data objects and personalization</h2>
<p>A major capability of Trust X is to safely store cryptographic material, such as private keys for authentication, or public-key certificates for verification.</p>
<p>These credentials are stored in highly-protected areas of Trust X. These areas are called <b>data objects</b>, and they can be protected from reading or writing. Typically, these data objects are initialized by the product manufacturer or system owner, for example during production. In order to properly initialize the data objects, the native Util API provides the functions:</p>
<ul>
<li><a class="el" href="group__gr_optiga_util.html#ga981ce4f3ff15113bdfa413490fbac4ef" title="Reads data from optiga.">optiga_util_read_data()</a></li>
<li><a class="el" href="group__gr_optiga_util.html#gadae27d12a34d3cc2abebc325ee0760a9" title="Writes data to optiga.">optiga_util_write_data()</a></li>
<li><a class="el" href="group__gr_optiga_util.html#gae9e919b41836e5538e580b1c7aeb92b5" title="Reads metadata of a data object from optiga.">optiga_util_read_metadata()</a></li>
<li><a class="el" href="group__gr_optiga_util.html#gae0dd1e82cfb379106cf79d9c2e5aaa38" title="Writes metadata for the user provided data object.">optiga_util_write_metadata()</a></li>
</ul>
<p>A complete example demonstrating the personalization of Trust X data objects for Amazon AWS is located on Github: <a href="https://github.com/Infineon/personalize-optiga-trust-x" target="_blank">Trust X Personalization</a>. A complete documentation for the API is available at <a href="https://github.com/Infineon/optiga-trust-x/wiki/Trust-X-Crypt-API" target="_blank">Crypt API</a>.</p>
<h1><a class="anchor" id="lib_ifx_optiga_i2c"></a>
I2C Protocol Stack Library</h1>
<p>The Infineon I2C Protocol Stack library enables communication with Infineon OPTIGA Trust X products. The protocol stack consists of three layers that relate to the ISO OSI (Open Systems Interconnection) model: transport, data link, and physical. Beneath is a host-specific platform abstraction layer (PAL), which interfaces to a host's I2C driver or I2C peripheral.</p>
<p>Please see <a class="el" href="lib_ifx_i2c.html">Infineon I2C Protocol Stack Library</a> for more details. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon Sep 14 2020" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
