<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v17.0.2: Capability Container file parser</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v17.0.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s113"><a href="../s113/index.html">S113 SoftDevice API</a></td>
<td class="doclinks" id="s122"><a href="../s122/index.html">S122 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s113","s122","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nfc_t4t_cc_parser_dox.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Capability Container file parser </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To detect and access <a class="el" href="nfc_ndef_dox.html">NFC Data Exchange Format</a> data, the NFC reader uses the Capability Container (CC) file contained inside the NDEF Tag Application. The CC file is a read-only file with file identifier equal to E103h. It is used to store management data for the Type 4 Tag platform.</p>
<p>The CC file module provides functions to parse raw CC file data to its descriptor structure. The API of the module is described in <a class="el" href="group__nfc__t4t__cc__file.html">CC file parser</a>.</p>
<h1><a class="anchor" id="nfc_t4t_cc_parser_format"></a>
CC file format</h1>
<p>You can use the module to print out the tag content. The output of the parser consists of the following data:</p>
<table class="doxtable">
<tr>
<th>Field name </th><th>Description</th></tr>
<tr>
<td>CCLEN </td><td>Size of the CC file. </td></tr>
<tr>
<td>Mapping Version </td><td>Type 4 Tag version number. </td></tr>
<tr>
<td>MLe </td><td>Maximum R-APDU data size. </td></tr>
<tr>
<td>MLc </td><td>Maximum C-APDU data size. </td></tr>
<tr>
<td>Extended NDEF/NDEF File Control TLV </td><td>Management data for the NDEF file with its payload. </td></tr>
<tr>
<td>TLV Blocks </td><td>One or more TLV blocks may be present (optional). </td></tr>
</table>
<p>Certain types of TLV blocks are supported by Type 4 Tag:</p>
<table class="doxtable">
<tr>
<th>TLV Block Name </th><th>Tag Field Value </th><th>Length Field Value</th></tr>
<tr>
<td>NDEF File Control TLV </td><td>04h </td><td>06h </td></tr>
<tr>
<td>Proprietary File Control TLV </td><td>05h </td><td>06h </td></tr>
<tr>
<td>Extended NDEF File Control TLV </td><td>06h </td><td>08h </td></tr>
</table>
<p>More detailed information about each TLV block inside Type 4 Tag is also printed out. The output of the parser consists of the following data:</p>
<table class="doxtable">
<tr>
<th>Field name </th><th>Description</th></tr>
<tr>
<td>File identifier </td><td>Used for the Select procedure. </td></tr>
<tr>
<td>Maximum file size </td><td>Maximum capacity of the file (in bytes). </td></tr>
<tr>
<td>Read access condition </td><td>Read access level of the file. </td></tr>
<tr>
<td>Write access condition </td><td>Write access level of the file. </td></tr>
</table>
<p>Optionally, content of the file (described by the TLV block) can also be printed out. However, in such case you must call an additional function which binds the TLV structure with the described file content.</p>
<h1><a class="anchor" id="nfc_t4t_cc_parser_examples"></a>
Parsing the CC file</h1>
<p>The following code example shows how to parse raw CC file data from a Type 4 Tag:</p>
<div class="fragment"><div class="line"><a class="code" href="group__sdk__error.html#gaf6c20fb483036617204f12e99e0b997b" title="API Result.">ret_code_t</a> err_code;</div>
<div class="line">uint8_t    cc_file_buff[] = ...; <span class="comment">//Buffer with raw CC file data.</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__nfc__t4t__cc__file.html#ga9aede4d9ef882d6327fca28fd01e6d01" title="Macro for creating and initializing a Type 4 Tag Capability Container descriptor.">NFC_T4T_CC_DESC_DEF</a>(cc_file, MAX_TLV_BLOCKS);</div>
<div class="line"><a class="code" href="structnfc__t4t__capability__container__t.html" title="Descriptor for the Capability Container (CC) file of Type 4 Tag.">nfc_t4t_capability_container_t</a> * p_cc_file = &amp;<a class="code" href="group__nfc__t4t__cc__file.html#gab4f24eb4aac9178b41d65ad20fa47c9c" title="Macro for accessing the nfc_t4t_capability_container_t instance that was created with NFC_T4T_CC_DESC...">NFC_T4T_CC_DESC</a>(cc_file);</div>
<div class="line"></div>
<div class="line">err_code = <a class="code" href="group__nfc__t4t__cc__file.html#ga52e4dadccb28b21a3b0b1f0be2a98abf" title="Function for parsing raw data of a CC file, read from a Type 4 Tag.">nfc_t4t_cc_file_parse</a>(p_cc_file, cc_file_buff, <span class="keyword">sizeof</span>(cc_file_buff));</div>
<div class="line"><span class="keywordflow">if</span> (err_code != <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123">NRF_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Error during CC file parsing.</span></div>
<div class="line">    <span class="keywordflow">return</span> err_code;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Print the CC file.</span></div>
<div class="line"><a class="code" href="group__nfc__t4t__cc__file.html#ga7f0a2335b9573740550f55cac4e44085" title="Function for printing the CC file descriptor.">nfc_t4t_cc_file_printout</a>(cc_file);</div>
</div><!-- fragment --><p>Apart from parsing raw CC file data, this module can be used to search for File Control TLVs within a CC file. The following code example shows this functionality:</p>
<div class="fragment"><div class="line"><a class="code" href="structnfc__t4t__tlv__block__t.html" title="File Control TLV block descriptor.">nfc_t4t_tlv_block_t</a> * p_tlv_block;</div>
<div class="line"></div>
<div class="line">p_tlv_block = nfc_t4t_file_control_tlv_get(p_cc_file, 0xE104);</div>
<div class="line"><span class="keywordflow">if</span> (p_tlv_block == NULL)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// File Control TLV with File Identifier 0xE104 was not found.</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group__nrf__error.html#ga349d25ada15be023e0d507f45ada682c">NRF_ERROR_NOT_FOUND</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following example shows how to use this module to bind a File Control TLV with its file content:</p>
<div class="fragment"><div class="line">uint8_t ndef_file_buff[] = ...; <span class="comment">//Buffer with raw NDEF file data.</span></div>
<div class="line"><a class="code" href="structnfc__t4t__file__t.html" title="File content descriptor.">nfc_t4t_file_t</a> file =           <span class="comment">//File descriptor.</span></div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="structnfc__t4t__file__t.html#a64d6e537c62843bc3ab30cb33bacdb8a" title="Pointer to the file content.">p_content</a> = (uint8_t *) ndef_file_buff,</div>
<div class="line">    .len       = <span class="keyword">sizeof</span>(ndef_file_buff)</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">err_code = <a class="code" href="group__nfc__t4t__cc__file.html#gaf5c2d7eaa6c4114cccea74175d7322b6" title="Function for binding a file with its File Control TLV block.">nfc_t4t_file_content_set</a>(p_cc_file, file, 0xE104);</div>
<div class="line"><span class="keywordflow">if</span> (err_code != <a class="codeRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123">NRF_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Error during the operation.</span></div>
<div class="line">    <span class="keywordflow">return</span> err_code;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note that if you want to store all data from a Type 4 Tag within a CC file structure, you must first parse raw CC file data and then bind all detected files with the tag's TLV blocks. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon Sep 14 2020" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
