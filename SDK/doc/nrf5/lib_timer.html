<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v17.0.2: Timer library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v17.0.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s112"><a href="../s112/index.html">S112 SoftDevice API</a></td>
<td class="doclinks" id="s113"><a href="../s113/index.html">S113 SoftDevice API</a></td>
<td class="doclinks" id="s122"><a href="../s122/index.html">S122 SoftDevice API</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<td class="doclinks" id="s312"><a href="../s312/index.html">S312 SoftDevice API</a></td>
<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>
<td class="doclinks" id="s340"><a href="../s340/index.html">S340 SoftDevice API</a></td>
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s112","s113","s122","s132","s140","s212","s312","s332","s340"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lib_timer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Timer library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The timer library (also referred to as app_timer) enables the application to create multiple timer instances based on the RTC1 peripheral. Start and stop requests, checking for time-outs and invoking the user time-out handlers is performed in the RTC1 interrupt handler. RTC1 interrupt priority level can be configured in sdk_config.h.</p>
<h1><a class="anchor" id="lib_timer_usage"></a>
Usage</h1>
<p>Configuration of the app_timer module is static. It is located in the sdk_config.h file. Use function <a class="el" href="group__app__timer.html#ga6dfeb220d038adefe101dd483c48d036">app_timer_init</a> to initialize the library.</p>
<p>To define a timer, use the <a class="el" href="group__app__timer.html#gaf8712d5f21788ee57a694e9d3303d9ee">APP_TIMER_DEF</a> macro. This macro allocates memory for the timer instance and declares an identifier that can later on be used to refer to the specific instance. Before starting a timer, the timer must be created:</p>
<div class="fragment"><div class="line"><a class="code" href="group__app__timer.html#gaf8712d5f21788ee57a694e9d3303d9ee" title="Create a timer identifier and statically allocate memory for the timer.">APP_TIMER_DEF</a>(my_timer_id);</div>
<div class="line">err_code = <a class="code" href="group__app__timer.html#ga5c31f03a2b9d4bf2a3cd629e6603e72e" title="Function for creating a timer instance.">app_timer_create</a>(&amp;my_timer_id, mode, timeout_handler)</div>
</div><!-- fragment --><p>After the timer is created, it can be controlled using <a class="el" href="group__app__timer.html#gaa2e52b98d7c4030d5e283ddfe50c81c7">app_timer_start</a> and <a class="el" href="group__app__timer.html#gac1b5d0e8d96612e331952a19c83e79f8">app_timer_stop</a>.</p>
<p>When <a class="el" href="group__app__timer.html#gaa2e52b98d7c4030d5e283ddfe50c81c7" title="Function for starting a timer.">app_timer_start()</a> or <a class="el" href="group__app__timer.html#gac1b5d0e8d96612e331952a19c83e79f8" title="Function for stopping the specified timer.">app_timer_stop()</a> are called, the timer operation is only queued, not executed. A RTC1 interrupt is triggered and the actual timer start/stop operation is executed by the RTC1 interrupt handler. If the application code that calls the timer function is running at the same or higher interrupt priority level, the timer operation will not be performed until the application handler has returned. This is the case, for example, when stopping a timer from a time-out handler when not using the scheduler.</p>
<p>To use this library with <a class="el" href="group__app__scheduler.html">Scheduler</a>, use the APP_TIMER_CONFIG_USE_SCHEDULER option in sdk_config.h.</p>
<h2><a class="anchor" id="lib_timer_debugging"></a>
Debugging</h2>
<p>The module exposes API for pausing and resuming RTC. It can be used in debugging hooks when entering and leaving breakpoints. Such hooks are available in J-Link Monitor, see <a href="https://devzone.nordicsemi.com/blogs/877/monitor-mode-debugging-revolutionize-the-way-you-d" target="_blank">Monitor Mode Debugging - Revolutionize the way you debug BLE applications</a>.</p>
<h1><a class="anchor" id="lib_timer_migration"></a>
Migration note</h1>
<p>When migrating from an SDK released before version 13.0.0, keep in mind that some changes have been introduced to the timer library in SDK v13.0.0. It might be necessary to adjust the code of your application to comply with these changes.</p>
<ol type="1">
<li>Static configuration of the module has been moved to sdk_config.h and thus the <code>APP_TIMER_INIT</code> macro has been removed. Therefore, you must change the following code: <div class="fragment"><div class="line">APP_TIMER_INIT(PRESCALER, OP_QUEUE_SIZE, SCHEDULER_FUNC);</div>
</div><!-- fragment --> to: <div class="fragment"><div class="line">err_code = <a class="code" href="group__app__timer.html#ga6dfeb220d038adefe101dd483c48d036" title="Function for initializing the timer module.">app_timer_init</a>();</div>
</div><!-- fragment --></li>
<li>The PRESCALER parameter has been removed from the <a class="el" href="group__app__timer.html#ga366b87f5e3b8d881f22a7209e5b3ae82">APP_TIMER_TICKS</a> macro. Therefore, you must change the following code: <div class="fragment"><div class="line">ticks = <a class="code" href="group__app__timer.html#ga366b87f5e3b8d881f22a7209e5b3ae82" title="Convert milliseconds to timer ticks.">APP_TIMER_TICKS</a>(MS, PRESCALER);</div>
</div><!-- fragment --> to: <div class="fragment"><div class="line">ticks = <a class="code" href="group__app__timer.html#ga366b87f5e3b8d881f22a7209e5b3ae82" title="Convert milliseconds to timer ticks.">APP_TIMER_TICKS</a>(MS);</div>
</div><!-- fragment --></li>
<li><code>app_timer_cnt_diff_compute</code> API change - The tick diff value is now returned by the function and not by the pointer. Therefore, you must change the following code: <div class="fragment"><div class="line">err_code = <a class="code" href="group__app__timer.html#ga19d88a7d3da7d03f8a2c956a2ac5ccf3" title="Function for computing the difference between two RTC1 counter values.">app_timer_cnt_diff_compute</a>(ticks_to, ticks_from, &amp;ticks_diff);</div>
</div><!-- fragment --> to: <div class="fragment"><div class="line">ticks_diff = <a class="code" href="group__app__timer.html#ga19d88a7d3da7d03f8a2c956a2ac5ccf3" title="Function for computing the difference between two RTC1 counter values.">app_timer_cnt_diff_compute</a>(ticks_to, ticks_from);</div>
</div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Mon Sep 14 2020" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
